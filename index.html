<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semillas De La Oportunidad - Proyecto de Donaciones</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }

        body {
            font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
            background:linear-gradient(135deg,#8B7355 0%,#D2B48C 100%);
            min-height:100vh; color:#8B7355;
        }

        header {
            background:rgba(255,255,255,.98); padding:20px 0;
            box-shadow:0 2px 10px rgba(0,0,0,.1);
            position:sticky; top:0; z-index:100;
        }
        .header-content { max-width:1200px; margin:auto; padding:0 20px;
            display:flex; justify-content:space-between; align-items:center; }
        .logo { font-size:28px; font-weight:bold; color:#8B7355; display:flex;
            align-items:center; gap:10px; }
        nav { display:flex; gap:30px; }
        nav a { text-decoration:none; color:#2C2C2C; font-weight:500;
            cursor:pointer; transition:color .3s; }
        nav a:hover { color:#8B7355; }

        .container { max-width:1200px; margin:auto; padding:40px 20px; }

        section { display:none; animation:fadeIn .5s ease-in; }
        section.active { display:block; }
        @keyframes fadeIn { from{opacity:0;} to{opacity:1;} }

        .hero { text-align:center; color:white; margin:60px; }
        .hero h1 { font-size:48px; margin-bottom:20px; text-shadow:2px 2px 4px rgba(0,0,0,.3); }
        .hero p { font-size:20px; margin-bottom:30px; opacity:.95; }

        .card { background:white; border-radius:12px; padding:30px;
            margin-bottom:30px; box-shadow:0 4px 15px rgba(0,0,0,.1); }
        .card h2 { color:#8B7355; margin-bottom:20px; font-size:28px; }

        .grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
            gap:20px; margin-top:20px; }

        .how-it-works-item { text-align:center; padding:20px;
            background:#FAF9F6; border-radius:10px; border:2px solid #D2B48C;
            transition:transform .3s,box-shadow .3s; }
        .how-it-works-item:hover { transform:translateY(-5px);
            box-shadow:0 4px 15px rgba(139,115,85,.2); }
        .how-it-works-item .number { font-size:36px; font-weight:bold;
            color:#8B7355; margin-bottom:15px; display:inline-block;
            padding:10px 20px; background:#F5F5DC; border-radius:50%; }

        .product-card { background:#FAF9F6; border-radius:10px; padding:20px;
            border:2px solid #D2B48C; transition:all .3s; cursor:pointer; }
        .product-card:hover { border-color:#8B7355; box-shadow:0 4px 15px rgba(139,115,85,.2);
            transform:translateY(-5px); }
        .product-card.verified { border-color:#8B7355; background:#F5F5DC; }
        .product-card.reserved { border-color:#666; background:#E8E8E8; opacity:.8; }
        .product-card.rejected { border-color:#2C2C2C; background:#E8E8E8; }

        .badge { display:inline-block; padding:5px 12px; border-radius:20px;
            font-size:12px; font-weight:bold; margin-bottom:10px; }
        .badge.verified { background:#8B7355; color:white; }
        .badge.reserved { background:#666; color:white; }
        .badge.pending { background:#D2B48C; color:#2C2C2C; }
        .badge.rejected { background:#2C2C2C; color:white; }

        form { display:flex; flex-direction:column; gap:15px; }
        input, textarea, select { padding:12px; border:2px solid #D2B48C;
            border-radius:6px; font-size:14px; transition:border-color .3s;
            background:#FAF9F6; }
        input:focus, textarea:focus, select:focus { outline:none; border-color:#8B7355; }
        textarea { resize:vertical; min-height:100px; }

        button { padding:12px 30px; border:none; border-radius:6px;
            font-size:16px; font-weight:bold; cursor:pointer; transition:all .3s; }
        .btn-primary { background:linear-gradient(135deg,#8B7355 0%,#D2B48C 100%);
            color:white; }
        .btn-primary:hover { transform:translateY(-2px);
            box-shadow:0 4px 12px rgba(139,115,85,.3); }
        .btn-secondary { background:#F5F5DC; color:#2C2C2C; }
        .btn-secondary:hover { background:#D2B48C; }
        .btn-approve { background:#8B7355; color:white; padding:8px 16px; font-size:14px; }
        .btn-reject { background:#2C2C2C; color:white; padding:8px 16px; font-size:14px; }

        .upload-area { border:2px dashed #8B7355; border-radius:8px;
            padding:40px; text-align:center; cursor:pointer; transition:all .3s;
            background:#FAF9F6; }
        .upload-area:hover { background:#F5F5DC; border-color:#D2B48C; }
        .upload-area.dragover { background:#F5F5DC; border-color:#8B7355; }
        .upload-area input[type="file"] { display:none; }
        .preview-image { max-width:100%; max-height:150px; margin-top:15px;
            border-radius:6px; object-fit:contain; }

        .verification-item { background:white; border-radius:10px;
            padding:20px; margin-bottom:20px; border:2px solid #D2B48C; }
        .verification-item img { max-width:150px; max-height:150px;
            border-radius:6px; margin:15px 0; object-fit:contain; display:block !important; }
        .verification-actions { display:flex; gap:10px; margin-top:15px; }

        .recommendation-box { background:#E8E8E8; border-left:4px solid #2C2C2C;
            padding:15px; border-radius:6px; margin-top:10px; }
        .recommendation-box h4 { color:#2C2C2C; margin-bottom:5px; }
        .recommendation-box p { color:#4A4A4A; font-size:14px; }

        .stats { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
            gap:20px; margin-bottom:30px; }
        .stat-box { background:white; padding:20px; border-radius:10px;
            text-align:center; box-shadow:0 2px 8px rgba(0,0,0,.1); }
        .stat-box .number { font-size:32px; font-weight:bold; color:#8B7355; }
        .stat-box .label { color:#666; margin-top:10px; }

        .notification-modal { 
            display:none; position:fixed; top:20px; right:20px;
            background:white; padding:20px; border-radius:10px;
            box-shadow:0 4px 20px rgba(0,0,0,.15); z-index:1000;
            animation:slideIn .3s ease-out; max-width:400px; font-size:14px;
        }
        .notification-modal.show { display:block; }
        @keyframes slideIn { from{transform:translateX(450px);opacity:0;}
            to{transform:translateX(0);opacity:1;} }
        .notification-modal.success { border-left:4px solid #8B7355; }
        .notification-modal.info { border-left:4px solid #D2B48C; }

        .info-section { display:grid; gap:30px; align-items:stretch; }
        .info-section .box {
            background:#FAF9F6; padding:20px; border-radius:10px;
            border:1px solid #D2B48C; box-shadow:0 2px 8px rgba(0,0,0,.05);
            display:flex; flex-direction:column; justify-content:flex-start;
        }
        .info-section .box h3 {
            color:#8B7355; margin-bottom:15px; font-size:1.4em;
        }
        .info-section .box p { line-height:1.8; flex-grow:1; }

        .logo-box { display:flex; flex-direction:column; align-items:center;
            justify-content:center; text-align:center; padding:25px 15px !important; }
        .logo-box img {
            max-width:75%; max-height:140px; border-radius:12px;
            box-shadow:0 6px 16px rgba(0,0,0,.12); margin-top:12px;
            transition:transform .3s ease;
        }
        .logo-box img:hover { transform:scale(1.05); }

        .references-box { padding:28px 32px !important; line-height:2.1; font-size:15px; }
        .references-box p { margin:0; }
        .references-box strong { color:#8B7355; font-weight:600; }

        @media (max-width:768px){
            .info-section{grid-template-columns:1fr;}
            nav{gap:15px;}
            .hero h1{font-size:32px;}
            .grid{grid-template-columns:1fr;}
            .references-box{padding:20px !important;line-height:1.9;}
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">Semillas de la oportunidad</div>
            <nav>
                <a onclick="showSection('home')">Inicio</a>
                <a onclick="showSection('about')">Sobre Nosotros</a>
                <a onclick="showSection('donate')">Donar Productos</a>
                <a onclick="showSection('receive')">Recibir Donaciones</a>
                <a onclick="showSection('verification')">Verificaci√≥n</a>
            </nav>
        </div>
    </header>

    <div class="container">
        <section id="home" class="active">
            <div class="hero">
                <h1>¬°Bienvenido a Semillas De La Oportunidad!</h1>
                <p>"Peque√±as donaciones, grandes oportunidades."</p>
            </div>

            <div class="stats">
                <div class="stat-box"><div class="number" id="stat-ni√±os">0</div><div class="label">Ni√±os Ayudados</div></div>
                <div class="stat-box"><div class="number" id="stat-donaciones">0</div><div class="label">Donaciones Verificadas</div></div>
                <div class="stat-box"><div class="number" id="stat-pendientes">0</div><div class="label">En Verificaci√≥n</div></div>
            </div>

            <div class="card">
                <h2>¬øC√≥mo funciona?</h2>
                <div class="grid">
                    <div class="how-it-works-item"><div class="number">1</div><h3 style="color:#8B7355;margin-bottom:10px;">Donar Productos</h3><p>Las personas suben fotos de los productos que desean donar</p></div>
                    <div class="how-it-works-item"><div class="number">2</div><h3 style="color:#8B7355;margin-bottom:10px;">Verificaci√≥n</h3><p>Nuestro equipo verifica que los productos cumplan los requisitos</p></div>
                    <div class="how-it-works-item"><div class="number">3</div><h3 style="color:#8B7355;margin-bottom:10px;">Recepci√≥n</h3><p>Los ni√±os reciben los productos verificados</p></div>
                </div>
            </div>
        </section>

        <section id="about">
            <div class="card">
                <h2>Sobre Semillas de la oportunidad</h2>

                <div class="info-section" style="grid-template-columns:1fr 1fr;margin-bottom:30px;">
                    <div class="box">
                        <h3>Nuestra Visi√≥n</h3>
                        <p>Ser una organizaci√≥n reconocida a nivel nacional por transformar vidas a trav√©s de la educaci√≥n, logrando que cada ni√±o y joven tenga acceso a lo necesario para aprender y crecer, construyendo una sociedad m√°s justa y solidaria.</p>
                    </div>

                    <div class="box">
                        <h3>Nuestra Misi√≥n</h3>
                        <p>Brindar apoyo a estudiantes que no cuentan con los recursos necesarios, mediante donaciones de uniformes, √∫tiles escolares y otros elementos que fortalezcan su educaci√≥n, impulsando la igualdad de oportunidades y sembrando esperanza en su futuro.</p>
                    </div>

                    <div class="box">
                        <h3>Objetivo General</h3>
                        <p>Brindar apoyo educativo a ni√±os en situaci√≥n de vulnerabilidad, proporcionando acceso gratuito a recursos digitales a trav√©s de una plataforma web, con el fin de garantizar su derecho a la educaci√≥n y contribuir a su desarrollo integral.</p>
                    </div>

                    <div class="box logo-box">
                        <h3>Logo</h3>
                        <img src="img/logo.jpg" alt="logo" style="width:200px;height:200px;">
                    </div>
                </div>

                <div class="info-section" style="grid-template-columns:1fr;">
                    <div class="box references-box">
                        <h3>Referencias de Personas</h3>
                        <p>
                            <strong>Mar√≠a G√≥mez:</strong> "Semillas de la Oportunidad cambi√≥ la vida de mi hijo al proporcionarle los √∫tiles escolares que necesitaba. ¬°Gracias por su gran trabajo!"<br>
                            <strong>Luc√≠a Fern√°ndez:</strong> "Gracias a Semillas de la Oportunidad, mis dos hijos pudieron empezar el a√±o escolar con todo lo necesario. ¬°Su ayuda marc√≥ la diferencia!"<br>
                            <strong>Andr√©s Rojas:</strong> "Recibir los uniformes fue un gran alivio para nuestra familia. Ahora mis ni√±os van felices al colegio todos los d√≠as."<br>
                            <strong>Patricia Morales:</strong> "El kit escolar que nos entregaron permiti√≥ que mi hija continuara estudiando sin preocupaciones. Agradezco de coraz√≥n su labor."<br>
                            <strong>Juan P√©rez:</strong> "Donar a trav√©s de esta plataforma fue f√°cil y gratificante. Saber que mi aporte ayuda a un ni√±o a estudiar me llena de alegr√≠a."
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <section id="donate">
            <div class="card">
                <h2>Quiero Donar Productos</h2>
                <p style="margin-bottom:20px;color:#666;">Por favor sube una foto clara de tu producto para verificaci√≥n</p>
                <form id="donationForm">
                    <input type="text" placeholder="Tu nombre completo" required>
                    <input type="email" placeholder="Tu correo electr√≥nico" required>
                    <input type="tel" placeholder="Tu n√∫mero de tel√©fono" required>
                    <label style="font-weight:bold;color:#2C2C2C;margin-top:10px;">Tipo de producto:</label>
                    <select required>
                        <option value="">-- Selecciona un tipo --</option>
                        <option value="uniforme">Uniforme Escolar</option>
                        <option value="√∫tiles">√ötiles Escolares</option>
                        <option value="zapatos">Zapatos</option>
                        <option value="mochilas">Maletas</option>
                        <option value="libros">Libros</option>
                        <option value="otro">Otro</option>
                    </select>
                    <label style="font-weight:bold;color:#2C2C2C;margin-top:10px;">Descripci√≥n del producto:</label>
                    <textarea placeholder="Describe el producto, su estado, cantidad, etc..." required></textarea>
                    <label style="font-weight:bold;color:#2C2C2C;margin-top:10px;">Foto del producto:</label>
                    <div class="upload-area" id="uploadArea"><div>Haz clic o arrastra la foto aqu√≠</div>
                        <input type="file" id="productImage" accept="image/*" required>
                        <img id="preview" class="preview-image" style="display:none;">
                    </div>
                    <textarea placeholder="Notas adicionales..." style="min-height:80px;"></textarea>
                    <button type="submit" class="btn-primary">Enviar Donaci√≥n para Verificar</button>
                </form>
            </div>
        </section>

        <section id="receive">
            <div class="card">
                <h2>Productos Disponibles para Recibir</h2>
                <p style="margin-bottom:20px;color:#666;">Estos son los productos que han sido verificados y est√°n disponibles</p>
                <div class="grid" id="verifiedProducts">
                    <p style="grid-column:1/-1;text-align:center;color:#999;">No hay productos disponibles a√∫n. ¬°Vuelve pronto!</p>
                </div>
                <div id="requestFormContainer" style="display:none;margin-top:30px;">
                    <div class="card">
                        <h2>Solicitar Producto</h2>
                        <p style="margin-bottom:20px;color:#666;">Por favor, completa el formulario para solicitar el producto seleccionado.</p>
                        <form id="requestForm">
                            <input type="text" name="name" placeholder="Tu nombre completo" required>
                            <input type="email" name="email" placeholder="Tu correo electr√≥nico" required>
                            <input type="tel" name="phone" placeholder="Tu n√∫mero de tel√©fono" required>
                            <input type="text" name="address" placeholder="Tu direcci√≥n completa" required>
                            <input type="text" name="productType" id="productType" readonly style="background:#E8E8E8;">
                            <label style="font-weight:bold;color:#2C2C2C;margin-top:10px;">Motivo de la solicitud:</label>
                            <textarea name="reason" placeholder="Explica por qu√© necesitas este producto..." required></textarea>
                            <textarea name="notes" placeholder="Notas adicionales (opcional)" style="min-height:80px;"></textarea>
                            <div style="display:flex;gap:10px;">
                                <button type="submit" class="btn-primary">Enviar Solicitud</button>
                                <button type="button" class="btn-secondary" onclick="cancelRequest()">Cancelar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>

        <section id="verification">
            <div class="card">
                <h2>Centro de Verificaci√≥n de Productos</h2>
                <p style="margin-bottom:20px;color:#666;">Aqu√≠ se verifica cada donaci√≥n antes de llegar a los ni√±os</p>
                <div style="background:#F5F5DC;padding:15px;border-radius:6px;margin-bottom:20px;border-left:4px solid #D2B48C;">
                    <strong>Nota:</strong> En esta secci√≥n los administradores pueden aprobar o rechazar donaciones.
                </div>
                <div id="verificationList"><p style="text-align:center;color:#999;">No hay donaciones pendientes de verificaci√≥n</p></div>
            </div>
        </section>
    </div>

    <div class="notification-modal" id="notification"></div>

    <script>
        let donations = [], requests = [];

        // CORREGIDO: Ahora guarda y carga datos reales
        function saveDonations(){ 
            try {
                localStorage.setItem('donations', JSON.stringify(donations));
                console.log('‚úì Donaciones guardadas correctamente');
            } catch(e) {
                console.error('Error al guardar donaciones:', e);
            }
        }

        function saveRequests(){ 
            try {
                localStorage.setItem('requests', JSON.stringify(requests));
                console.log('‚úì Solicitudes guardadas correctamente');
            } catch(e) {
                console.error('Error al guardar solicitudes:', e);
            }
        }

        // CORREGIDO: Nueva funci√≥n para cargar datos
        function loadData(){
            try {
                const savedDonations = localStorage.getItem('donations');
                const savedRequests = localStorage.getItem('requests');
                
                donations = savedDonations ? JSON.parse(savedDonations) : [];
                requests = savedRequests ? JSON.parse(savedRequests) : [];
                
                console.log('‚úì Datos cargados:', {donations: donations.length, requests: requests.length});
            } catch(e) {
                console.error('Error al cargar datos:', e);
                donations = [];
                requests = [];
            }
        }

        function showSection(id){
            document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            window.scrollTo(0,0);
        }

        function showNotification(msg, type='success', duration=4000){
            const n = document.getElementById('notification');
            n.textContent = msg;
            n.className = `notification-modal show ${type}`;
            setTimeout(() => n.classList.remove('show'), duration);
        }

        const uploadArea = document.getElementById('uploadArea'), 
              fileInput = document.getElementById('productImage'), 
              preview = document.getElementById('preview');
        
        uploadArea.addEventListener('click', () => fileInput.click());
        uploadArea.addEventListener('dragover', e => { e.preventDefault(); uploadArea.classList.add('dragover'); });
        uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
        uploadArea.addEventListener('drop', e => { 
            e.preventDefault(); 
            uploadArea.classList.remove('dragover'); 
            if(e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files; 
                handleFileSelect(); 
            }
        });
        fileInput.addEventListener('change', handleFileSelect);
        
        // CORREGIDO: Mejor manejo de errores en lectura de archivos
        function handleFileSelect(){
            if(fileInput.files.length){
                const file = fileInput.files[0];
                
                if(!file.type.startsWith('image/')){
                    showNotification('Por favor selecciona un archivo de imagen v√°lido', 'info');
                    fileInput.value = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = e => { 
                    preview.src = e.target.result; 
                    preview.style.display = 'block'; 
                };
                reader.onerror = () => {
                    showNotification('Error al cargar la imagen. Intenta con otra.', 'info');
                };
                reader.readAsDataURL(file);
            }
        }

        // CORREGIDO: Validaci√≥n de imagen antes de enviar
        document.getElementById('donationForm').addEventListener('submit', e => {
            e.preventDefault();
            
            // Validar que hay una imagen cargada
            if(!preview.src || preview.style.display === 'none'){
                showNotification('Por favor sube una foto del producto antes de enviar', 'info');
                return;
            }
            
            const donation = {
                id: Date.now(),
                name: e.target[0].value,
                email: e.target[1].value,
                phone: e.target[2].value,
                type: e.target[4].value,
                description: e.target[5].value,
                image: preview.src,
                notes: e.target[7].value,
                status: 'pending',
                date: new Date().toLocaleString('es-ES')
            };
            
            donations.push(donation);
            saveDonations();
            updateStats();
            
            showNotification('¬°Gracias por tu donaci√≥n! Est√° en revisi√≥n.', 'success', 5000);

            e.target.reset();
            preview.style.display = 'none';
            preview.src = '';
            updateVerificationList();
            simulateAdminNotification(donation);
        });

        function simulateAdminNotification(d){
            console.log('üì± SIMULACI√ìN SMS a 3213532029: Nueva donaci√≥n de '+d.name+' - '+d.type);
            console.log('üì± SIMULACI√ìN SMS a 3203212581: Nueva donaci√≥n de '+d.name+' - '+d.type);
        }

        function updateVerificationList(){
            const list = document.getElementById('verificationList');
            const pending = donations.filter(d => d.status !== 'approved' && d.status !== 'reserved');
            
            if(!pending.length){
                list.innerHTML = '<p style="text-align:center;color:#999;">No hay donaciones para verificar</p>'; 
                return;
            }
            
            list.innerHTML = pending.map(d => `
                <div class="verification-item">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div><span class="badge ${d.status}">${d.status.toUpperCase()}</span>
                            <h3 style="color:#2C2C2C;margin:10px 0;">${d.name} - ${d.type}</h3>
                            <p><strong>Email:</strong> ${d.email}</p>
                            <p><strong>Tel√©fono:</strong> ${d.phone}</p>
                            <p><strong>Fecha:</strong> ${d.date}</p>
                        </div>
                    </div>
                    <p style="margin:10px 0;"><strong>Descripci√≥n:</strong> ${d.description}</p>
                    ${d.notes ? `<p><strong>Notas:</strong> ${d.notes}</p>` : ''}
                    <img src="${d.image}" alt="Producto">
                    ${d.status === 'pending' ? `
                    <div class="verification-actions">
                        <button class="btn-approve" onclick="approveDonation(${d.id})">Aprobar</button>
                        <button class="btn-reject" onclick="rejectDonation(${d.id})">Rechazar</button>
                    </div>` : (d.status === 'rejected' ? `
                    <div class="recommendation-box"><h4>Recomendaci√≥n</h4><p>${d.rejectionReason}</p></div>` : '')}
                </div>`).join('');
        }

        function approveDonation(id){
            const d = donations.find(x => x.id === id);
            if(d){ 
                d.status = 'approved'; 
                saveDonations(); 
                updateStats();
                updateVerificationList(); 
                updateVerifiedProducts();
                showNotification(`Donaci√≥n de ${d.name} aprobada`, 'success', 5000); 
            }
        }

        function rejectDonation(id){
            const d = donations.find(x => x.id === id);
            if(d){
                const reason = prompt('¬øPor qu√© rechazas esta donaci√≥n?', 'El producto no cumple con los requisitos');
                if(reason !== null && reason.trim() !== ''){ 
                    d.status = 'rejected'; 
                    d.rejectionReason = reason; 
                    saveDonations(); 
                    updateStats();
                    updateVerificationList(); 
                    showNotification('Donaci√≥n rechazada', 'info', 5000); 
                }
            }
        }

        function showRequestForm(id){
            const p = donations.find(d => d.id === id && d.status === 'approved');
            if(p){
                const cont = document.getElementById('requestFormContainer');
                document.getElementById('productType').value = p.type;
                cont.style.display = 'block';
                document.getElementById('requestForm').dataset.productId = id;
                window.scrollTo({ top: cont.offsetTop, behavior: 'smooth' });
            }
        }

        function cancelRequest(){
            document.getElementById('requestFormContainer').style.display = 'none';
            document.getElementById('requestForm').reset();
        }

        document.getElementById('requestForm').addEventListener('submit', e => {
            e.preventDefault();
            const fd = new FormData(e.target);
            const pid = parseInt(e.target.dataset.productId);
            
            const req = {
                id: Date.now(), 
                productId: pid,
                name: fd.get('name'), 
                email: fd.get('email'), 
                phone: fd.get('phone'),
                address: fd.get('address'),
                productType: fd.get('productType'), 
                reason: fd.get('reason'), 
                notes: fd.get('notes'),
                date: new Date().toLocaleString('es-ES')
            };
            
            requests.push(req);
            saveRequests();

            showNotification(
                `¬°Gracias, ${req.name}! Tu solicitud para "${req.productType}" ha sido recibida. Con este paso, est√°s sembrando una semilla de esperanza para un futuro mejor. Nos pondremos en contacto contigo pronto para coordinar la entrega. ¬°Juntos creamos oportunidades!`,
                'success',
                15000
            );

            const prod = donations.find(d => d.id === pid);
            if(prod){ 
                prod.status = 'reserved'; 
                saveDonations(); 
                updateVerifiedProducts();
                updateStats();
            }
            
            e.target.reset();
            document.getElementById('requestFormContainer').style.display = 'none';
        });

        function updateVerifiedProducts(){
            const cont = document.getElementById('verifiedProducts');
            const approved = donations.filter(d => d.status === 'approved' || d.status === 'reserved');
            
            if(!approved.length){
                cont.innerHTML = '<p style="grid-column:1/-1;text-align:center;color:#999;">No hay productos disponibles a√∫n. ¬°Vuelve pronto!</p>'; 
                return;
            }
            
            cont.innerHTML = approved.map(p => `
                <div class="product-card ${p.status}">
                    <span class="badge ${p.status}">${p.status === 'approved' ? 'VERIFICADO' : 'RESERVADO'}</span>
                    <h3 style="color:#2C2C2C;margin:10px 0;">${p.type}</h3>
                    <p><strong>Donante:</strong> ${p.name}</p>
                    <p style="margin:10px 0;">${p.description}</p>
                    <img src="${p.image}" alt="Producto" style="width:100%;border-radius:6px;margin:10px 0;">
                    ${p.status === 'approved' ? `<button class="btn-primary" style="width:100%;margin-top:10px;" onclick="showRequestForm(${p.id})">Solicitar este producto</button>` :
                    `<p style="text-align:center;color:#666;">Este producto ya ha sido reservado.</p>`}
                </div>`).join('');
        }

        function updateStats(){
            const verified = donations.filter(d => d.status === 'approved' || d.status === 'reserved').length;
            const pending = donations.filter(d => d.status === 'pending').length;
            
            document.getElementById('stat-donaciones').textContent = verified;
            document.getElementById('stat-pendientes').textContent = pending;
            document.getElementById('stat-ni√±os').textContent = verified * 2;
        }

        // CORREGIDO: Cargar datos al inicio
        window.addEventListener('DOMContentLoaded', () => { 
            loadData(); 
            updateStats(); 
            updateVerificationList(); 
            updateVerifiedProducts(); 
            
            console.log('‚úì Aplicaci√≥n iniciada correctamente');
            console.log('üìä Estad√≠sticas:', {
                donaciones: donations.length,
                solicitudes: requests.length
            });
        });
    </script>
</body>
</html>